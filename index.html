<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Uber Lost & Found Index</title>
  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/screen1.css" />
</head>
<body class="screen1">

  <!-- 3D background -->
  <canvas id="taxiCanvas" aria-hidden="true"></canvas>

  <main class="screen1-wrap">
    <section class="hero-card" role="region" aria-label="Intro">
      <img class="uber-logo" src="images/uber_logo.png" alt="Uber" />
      <div class="hero-sub">Uber Lost &amp; Found Index 2021â€“2025</div>

      <a class="start-btn" href="screen2.html" aria-label="Start">START</a>
      <div class="hero-hint">Click to start</div>
    </section>
  </main>

  <!-- Three.js (CDN) -->
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>

  <script>
    (() => {
      const canvas = document.getElementById("taxiCanvas");
      if (!canvas || !window.THREE || !THREE.GLTFLoader) return;

      const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
      renderer.setPixelRatio(Math.min(2, window.devicePixelRatio));

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000);
      camera.position.set(0, 1.4, 5.2);

      scene.add(new THREE.AmbientLight(0xffffff, 1.1));
      const dir = new THREE.DirectionalLight(0xffffff, 1.2);
      dir.position.set(3, 6, 4);
      scene.add(dir);

      function resize() {
        const w = window.innerWidth, h = window.innerHeight;
        renderer.setSize(w, h, false);
        camera.aspect = w / h;
        camera.updateProjectionMatrix();
      }
      window.addEventListener("resize", resize);
      resize();

      let taxi = null;
      const loader = new THREE.GLTFLoader();
      loader.load(
        "fin/data/uber_taxi_3d.glb",
        (gltf) => {
          taxi = gltf.scene;
          taxi.scale.setScalar(0.9);
          taxi.position.set(0, -0.2, 0);
          taxi.rotation.y = Math.PI * 0.15;
          scene.add(taxi);
        },
        undefined,
        (err) => console.warn("GLB load error:", err)
      );

      const target = new THREE.Vector3(0, 0, 0);
      const current = new THREE.Vector3(0, 0, 0);
      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();
      const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);

      function setTarget(e) {
        const x = (e.clientX / window.innerWidth) * 2 - 1;
        const y = -(e.clientY / window.innerHeight) * 2 + 1;
        mouse.set(x, y);
        raycaster.setFromCamera(mouse, camera);

        const hit = new THREE.Vector3();
        raycaster.ray.intersectPlane(plane, hit);

        hit.x = Math.max(-2.2, Math.min(2.2, hit.x));
        hit.z = Math.max(-1.6, Math.min(1.6, hit.z));
        target.copy(hit);
      }

      window.addEventListener("mousemove", setTarget);
      window.addEventListener("click", setTarget);

      function animate() {
        requestAnimationFrame(animate);
        if (taxi) {
          current.lerp(target, 0.08);
          taxi.position.x = current.x;
          taxi.position.z = current.z;

          const dx = target.x - taxi.position.x;
          taxi.rotation.y = THREE.MathUtils.lerp(taxi.rotation.y, dx * 0.35, 0.06);
        }
        renderer.render(scene, camera);
      }
      animate();
    })();
  </script>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="js/screen1.js"></script>

</body>
</html>

<script src="js/cursorTrail.js"></script>

<script type="module" src="js/cursorTaxi3D_test.js"></script>
<script src="js/cursor_only.js"></script>
